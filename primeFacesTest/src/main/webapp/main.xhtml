<?xml version="1.0" encoding="utf-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>Каталог музыки</title>
        <link type="text/css" rel="stylesheet" href="#{request.contextPath}/css/style.css" />
        <style type="text/css">
            .nestedUnit {
                margin: 0px;
                border:0px none !important;
                overflow: hidden;
            }

            .bottomMenu {
                border:0px none !important;
                margin: auto;
                width:100%;
                padding: 0pt; 
            }

            .bottomButtons {
                width:100%;
            }

            .menu {
                border:0px none !important;
                margin-bottom: 10px;
                margin-top: 0px;
            }

            .ui-layout-center .ui-layout-resizer {
                border:1px solid #A8A8A8 !important;
            }

            body {
                font-family: arial;
                font-size: 10pt;
                text-align: left;
                overflow: auto;
            } 

            .mainbody {
                min-height: 800px;
                height:auto;
                text-align: center;
            }

            .centered {
                margin:0px auto;
                text-align: center;
            }

            .title {
                margin:5px auto; 
                text-align: center;
                font-size: 30pt;
                font-family: Arial;
            }

            .tools {
                margin-bottom: 0px; 
            }

            .table {
                width: 100%;
            }

            .ui-datatable-scrollable .ui-datatable-scrollable-header-box, .ui-datatable-scrollable .ui-datatable-scrollable-footer-box {
                float: left;
                padding-right: 17px;
            }

            li.ui-autocomplete-token {
                width: 95%;
            }

            .ui-autocomplete-multiple {
                margin-right: -8px;
            }

            .mainpanelGrid {
                width:300pt;
                height: 100pt;
                border:0px none !important;
                margin: auto;
            }

            .tableColumn1 {
                width:60pt;
            }

            .tableColumn2 {
                width:79%;
                padding-right: 0pt;
            }

            .ui-inputfield {
                width:100%;
            }

            .ui-panelgrid {
                border-collapse: separate;
            }

            .ui-panelgrid td {
                border:0px none !important;
                border-style: none;
            } 

            .panelPadding td{
                padding: 10px 4px 10px 4px;
            }

            .addDialogStyle {
                position: absolute;
                left: auto;
                right:auto;
            }
        </style>
    </h:head>

    <h:body onload="#{controllerManagedBean.search()}">
        <h1 style="text-align: center; margin: 5px auto; font-family: Arial;" >Каталог музыки</h1>
        <h:form id="form">
            <p:layout styleClass="mainbody">
                <p:layoutUnit id="Head" position="north" resizable="false" minSize="100" styleClass="nestedUnit">
                    <h:panelGrid columns="2" cellpadding="5" styleClass="centered">
                        <p:inputText id="search" size="60" value="#{controllerManagedBean.searchString}" />
                        <p:commandButton value="Поиск" update="basictable" action="#{controllerManagedBean.search()}"/>
                    </h:panelGrid>
                    <h:panelGrid columns="6" cellpadding="6" styleClass="centered">
                        <p:commandLink value="Лучшая группа" update=":topGroupsdialog" oncomplete="topGroupsDialog.show()"/>
                        <p:commandLink value="Треки выбранного альбома" update=":albumContentdialog" oncomplete="albumContentdialog.show()"/>
                        <p:commandLink value="Альбомы исполнителя" update=":musicianAlbumsDialog" oncomplete="musicianAlbumsDialog.show()"/>
                        <p:commandLink value="Рейтинг альбомов" update=":ratedAlbumsDialog" oncomplete="ratedAlbumsDialog.show()"/>
                        <p:commandLink value="Исполнители по жанру" update=":musiciansByGenreDialog" oncomplete="musiciansByGenreDialog.show()"/>
                        <p:commandLink value="Исполнители по настроению" update=":musiciansByMoodDialog" oncomplete="musiciansByMoodDialog.show()"/>
                    </h:panelGrid>
                </p:layoutUnit>

                <p:layoutUnit id="Body" position="center" minSize="800" styleClass="nestedUnit">
                    <p:layout styleClass="margin: 0px;">
                        <p:layoutUnit position="center"  resizable="true" styleClass="nestedUnit" >
                            <p:dataTable  id="basictable" var="row" value="#{controllerManagedBean.maintable}" styleClass="table"
                                          selection="#{controllerManagedBean.selectedRows}" rowKey="#{row.trackId}" selectionMode="multiple"
                                          scrollHeight="505" scrollable="true">  
                                <f:facet name="header">
                                    <p:commandButton id="addTrackButton" value="Добавить" icon="ui-icon-squaresmall-plus"  
                                                     update=":addDialogForm:addisplay" oncomplete="addDialog.show()" onclick="#{addDialogModelManagedBean.modeTrack()}"/>  
                                    <p:commandButton id="editButton" value="Редактировать" icon="ui-icon-pencil"  
                                                     action="#{controllerManagedBean.edit}" ajax="false"/>
                                    <p:commandButton id="deleteButton" value="Удалить" icon="ui-icon-pencil"  
                                                     action="#{controllerManagedBean.deleteTracks()}" update="basictable"/>
                                </f:facet>

                                <p:column style="width: 500px">  
                                    <f:facet name="header">Группа</f:facet>  
                                    <h:outputText value="#{row.groupName}" />  
                                </p:column>  

                                <p:column style="width: 500px">  
                                    <f:facet name="header">Альбом</f:facet>  
                                    <h:outputText value="#{row.albumName}" />  
                                </p:column>  

                                <p:column style="width: 500px">  
                                    <f:facet name="header">Трек</f:facet>  
                                    <h:outputText value="#{row.trackName}" />  
                                </p:column>

                                <p:column style="width: 200px">  
                                    <f:facet name="header">Рейтинг</f:facet>  
                                    <h:outputText value="#{row.avrrate}" id="avgRate">
                                        <f:convertNumber pattern = "##,##"/>
                                    </h:outputText> 
                                    <p:rating value="#{row.rate}" >
                                        <f:attribute name="trackId" value="#{row.trackId}"/>
                                        <p:ajax event="rate" update="avgRate"  listener="#{controllerManagedBean.rateTrack}"/>                                       
                                    </p:rating>
                                </p:column>

                                <p:column style="width: 500px">  
                                    <f:facet name="header">Жанр</f:facet>  
                                    <h:outputText value="#{row.genreName}" />  
                                </p:column>

                                <p:column style="width: 500px">  
                                    <f:facet name="header">Настроение</f:facet>  
                                    <h:outputText value="#{row.moodName}" />  
                                </p:column>
                            </p:dataTable> 
                        </p:layoutUnit>
                    </p:layout>                                    
                </p:layoutUnit>
            </p:layout>            
        </h:form> 

        <h:form id="addDialogForm">
            <p:growl id="growl"  showSummary="false" showDetail="true"/>

            <p:dialog id="adddialog" header="Создать" widgetVar="addDialog" closable="false" styleClass="addDialogStyle" 
                      showEffect="fade" hideEffect="fade" modal="true">                 
                <p:panelGrid id="addisplay"  styleClass="nestedUnit"> 
                    <p:row>
                        <p:column>
                            <p:panel id="trackPanel" header="Трек #{addDialogModelManagedBean.track.name}" visible="#{addDialogModelManagedBean.createTrackP()}">  
                                <p:panelGrid styleClass="mainpanelGrid" rendered="#{addDialogModelManagedBean.createTrackP()}">  
                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Название"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="trackNameInput" value="#{addDialogModelManagedBean.track.name}" 
                                                         required="true" label="Предупреждение" requiredMessage="Введите имя трека." /> 
                                        </p:column>
                                        <p:column/>
                                    </p:row>

                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Альбом" /> 
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:autoComplete id="trackAlbum" 
                                                            completeMethod="#{addDialogModelManagedBean.completeAlbums}" 
                                                            value="#{addDialogModelManagedBean.album}"
                                                            var="a" itemLabel="#{a.name}" itemValue="#{a}"
                                                            converter="albumConverter" 
                                                            forceSelection="true" required="true" requiredMessage="Выберете альбом."> 
                                                <p:ajax event="itemSelect"  process="@this, albumPanel, genrePanel, groupPanel, memberPanel, createButton" immediate="true"
                                                        update="albumPanel genrePanel groupPanel memberPanel, createButton" listener="#{addDialogModelManagedBean.albumSelectHandler}"/>
                                                <p:ajax event="blur" process="@this, trackAlbum" update="trackAlbum" />
                                            </p:autoComplete>
                                        </p:column>
                                        <p:column>
                                            <p:commandButton id="newAlbumButton"  value="+" process="@this, albumPanel, trackAlbum, createButton" update="albumPanel trackAlbum createButton" 
                                                             actionListener="#{addDialogModelManagedBean.newAlbumEventHandler()}" immediate="true"/>
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Настроение" />
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:autoComplete id="trackMood" 
                                                            completeMethod="#{addDialogModelManagedBean.completeMoods}" 
                                                            value="#{addDialogModelManagedBean.mood}"
                                                            var="a" itemLabel="#{a.name}" itemValue="#{a}"
                                                            converter="moodConverter" 
                                                            forceSelection="true" required="true" requiredMessage="Выберете настроение.">
                                                <p:ajax event="itemSelect" process="@this, moodPanel, createButton" immediate="true"
                                                        update="moodPanel createButton" listener="#{addDialogModelManagedBean.moodSelectHandler}"/>
                                                <p:ajax event="blur" update="trackMood" />
                                            </p:autoComplete>
                                        </p:column>
                                        <p:column>
                                            <p:commandButton id="newMoodButton" value="+" process="@this, moodPanel, trackMood, createButton" update="moodPanel trackMood createButton" 
                                                             actionListener="#{addDialogModelManagedBean.newMoodEventHandler()}" immediate="true"/>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>  
                            </p:panel> 
                        </p:column>

                        <p:column>
                            <p:panel id="albumPanel" header="Альбом #{addDialogModelManagedBean.album.name}" visible="#{addDialogModelManagedBean.createAlbumP()}" >  
                                <p:panelGrid styleClass="mainpanelGrid"  rendered="#{addDialogModelManagedBean.createAlbumP()}" > 
                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Название"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="albumNameInput" value="#{addDialogModelManagedBean.album.name}" required="true" requiredMessage="Введите название альбома.">
                                                <p:ajax event="keyup" process="@this, trackAlbum" update="trackAlbum"/>
                                                <p:ajax event="blur" process="@this, trackAlbum" update="trackAlbum"/>
                                            </p:inputText>
                                        </p:column>
                                        <p:column/>
                                    </p:row>

                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Группа" /> 
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:autoComplete id="albumGroup" 
                                                            completeMethod="#{addDialogModelManagedBean.completeGroups}" 
                                                            value="#{addDialogModelManagedBean.group}"
                                                            var="a" itemLabel="#{a.name}" itemValue="#{a}"
                                                            converter="groupConverter" 
                                                            forceSelection="true" required="true" requiredMessage="Выберете группу.">
                                                <p:ajax event="itemSelect" process="@this, groupPanel, memberPanel, createButton" immediate="true"
                                                        update="groupPanel createButton memberPanel" listener="#{addDialogModelManagedBean.groupSelectHandler}"/>
                                                <p:ajax event="blur" update="albumGroup" />
                                            </p:autoComplete>
                                        </p:column>
                                        <p:column>
                                            <p:commandButton id="newGroupButton" value="+" process="@this, groupPanel, albumGroup, memberPanel, createButton" immediate="true"
                                                             update="groupPanel albumGroup createButton memberPanel" actionListener="#{addDialogModelManagedBean.newGroupEventHandler()}"/>
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Жанр" /> 
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:autoComplete id="albumGenre" 
                                                            completeMethod="#{addDialogModelManagedBean.completeGenres}" 
                                                            value="#{addDialogModelManagedBean.genre}"
                                                            var="a" itemLabel="#{a.name}" itemValue="#{a}"
                                                            converter="genreConverter" 
                                                            forceSelection="true" required="true" requiredMessage="Выберете жанр.">
                                                <p:ajax event="itemSelect" process="@this, genrePanel, createButton" immediate="true"
                                                        update="genrePanel createButton" listener="#{addDialogModelManagedBean.genreSelectHandler}"/>
                                                <p:ajax event="blur" update="albumGenre" />
                                            </p:autoComplete>
                                        </p:column>
                                        <p:column>
                                            <p:commandButton id="newGenreButton" value="+" process="@this, genrePanel, albumGenre, createButton" immediate="true"
                                                             update="genrePanel albumGenre createButton" actionListener="#{addDialogModelManagedBean.newGenreEventHandler()}"/>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>  
                            </p:panel>
                        </p:column>

                        <p:column>
                            <p:panel id="groupPanel" header="Группа #{addDialogModelManagedBean.group.name}" visible="#{addDialogModelManagedBean.createGroupP()}">  
                                <p:panelGrid  styleClass="mainpanelGrid" rendered="#{addDialogModelManagedBean.createGroupP()}"> 
                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Название"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="groupNameInput" value="#{addDialogModelManagedBean.group.name}" required="true" requiredMessage="Введите название группы.">
                                                <p:ajax event="keyup" update="albumGroup"/>
                                                <p:ajax event="blur" update="albumGroup"/>
                                            </p:inputText>
                                        </p:column>
                                        <p:column/>
                                    </p:row>

                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Состав группы" /> 
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:autoComplete id="membersAutoComplete" 
                                                            value="#{addDialogModelManagedBean.members}" 
                                                            completeMethod="#{addDialogModelManagedBean.completeMusicians}" 
                                                            var="member" itemLabel="#{member.name}" 
                                                            itemValue="#{member}" 
                                                            converter="musicianConverter"
                                                            forceSelection="true" multiple="true">
                                                <p:ajax event="itemUnselect" update="membersAutoComplete"/>
                                                <p:ajax event="itemSelect" update="membersAutoComplete"/>
                                            </p:autoComplete>
                                        </p:column>
                                        <p:column>
                                            <p:commandButton id="newMemberButton" value="+" process="@this, memberPanel, createButton" update="memberPanel createButton" actionListener="#{addDialogModelManagedBean.newMemberEventHandler()}"/>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>  
                            </p:panel>
                        </p:column>
                    </p:row>

                    <p:row> 
                        <p:column>
                            <p:panel id="moodPanel" header="Настроение #{addDialogModelManagedBean.mood.name}" visible="#{addDialogModelManagedBean.createMoodP()}">  
                                <p:panelGrid styleClass="mainpanelGrid" rendered="#{addDialogModelManagedBean.createMoodP()}"> 
                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Название"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="MoodNameInput" value="#{addDialogModelManagedBean.mood.name}" required="true"  requiredMessage="Ввкдите название настроения.">
                                                <p:ajax event="keyup" update="trackMood"/>
                                                <p:ajax event="blur" update="trackMood"/>
                                            </p:inputText>
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Value"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="MoodValueInput" value="#{addDialogModelManagedBean.mood.value}" 
                                                         required="true" requiredMessage="Выберете значение для настроения." validatorMessage="Значение настроения должно быть в пределах 1 до 999.">
                                                <f:validateLongRange minimum="1" maximum="999" />
                                            </p:inputText>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>  
                            </p:panel>
                        </p:column>

                        <p:column>
                            <p:panel id="genrePanel" header="Жанр #{addDialogModelManagedBean.genre.name}" visible="#{addDialogModelManagedBean.createGenreP()}">  
                                <p:panelGrid styleClass="mainpanelGrid" rendered="#{addDialogModelManagedBean.createGenreP()}">  
                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Название"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="genreNameInput" value="#{addDialogModelManagedBean.genre.name}" required="true" requiredMessage="Введите название жанра.">
                                                <p:ajax event="keyup" update="albumGenre"/>
                                                <p:ajax event="blur" update="albumGenre"/>
                                            </p:inputText>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>  
                            </p:panel>
                        </p:column>
                        <p:column>
                            <p:panel id="memberPanel" header="Исполнитель #{addDialogModelManagedBean.musician.name}" visible="#{addDialogModelManagedBean.createMusicianP()}">  
                                <p:panelGrid styleClass="mainpanelGrid" rendered="#{addDialogModelManagedBean.createMusicianP()}">  
                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Название"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="memberNameInput" value="#{addDialogModelManagedBean.musician.name}" required="true" requiredMessage="Введите имя исполнителя."/>
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column styleClass="tableColumn1">
                                            <h:outputText value="Ссылка"/>   
                                        </p:column>
                                        <p:column styleClass="tableColumn2">
                                            <p:inputText id="memberLinkInput" value="#{addDialogModelManagedBean.musician.link}" />
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>  
                            </p:panel>
                        </p:column>
                    </p:row>

                    <p:row>
                        <p:column colspan="3">
                            <p:panelGrid id="commandPanel" columns="2" name="footer" styleClass="bottomMenu">  
                                <p:commandButton styleClass="bottomButtons" id="backButton"   update=":form:basictable" immediate="true"  value="Назад"   actionListener="#{addDialogModelManagedBean.backEventHandler()}"  oncomplete="addDialog.hide()" />  
                                <p:commandButton styleClass="bottomButtons" id="createButton" update="addisplay growl" process="@form" ajax="true" value="#{addDialogModelManagedBean.createUpdateButtonName}" action="#{addDialogModelManagedBean.createUpdate()}"/>                        
                            </p:panelGrid>
                        </p:column>
                    </p:row>
                </p:panelGrid>  
            </p:dialog>
        </h:form>

        <p:dialog id="topGroupsdialog" header="Лучшая группа" widgetVar="topGroupsDialog" styleClass="text-align: left;" showEffect="fade" hideEffect="fade" width="600">
            <p:dataList value="#{controllerManagedBean.searchTopGroups()}" var="group" type="ordered" styleClass="text-align: left;">
                #{group.key}, rate 
                <h:outputText value="#{group.value}">
                    <f:convertNumber pattern = "##,##"/>
                </h:outputText>
            </p:dataList>
        </p:dialog> 

        <p:dialog id="albumContentdialog" header="Треки выбранного альбома" widgetVar="albumContentdialog" showEffect="fade" hideEffect="fade" width="600">
            <p:dataTable  id="albumContenttable" var="row" value="#{controllerManagedBean.searchAlbumContent()}"  styleClass="table, centered">  
                <p:column id="modelHeader">  
                    <f:facet name="header">Группа</f:facet>  
                    <h:outputText value="#{row.key}" />  
                </p:column>  

                <p:column>  
                    <f:facet name="header">Трек</f:facet>  
                    <h:outputText value="#{row.value}" />  
                </p:column>  
            </p:dataTable> 
        </p:dialog>

        <p:dialog id="musicianAlbumsDialog" header="Альбомы исполнителя" widgetVar="musicianAlbumsDialog" showEffect="fade" hideEffect="fade" width="600">
            <p:autoComplete id="musicianAlbumsAutoComplete" 
                            value="#{mainPageViewManagedBean.selectedMusician}" 
                            completeMethod="#{mainPageViewManagedBean.completeMusicians}" 
                            var="member" itemLabel="#{member.name}" 
                            itemValue="#{member}" 
                            converter="musicianConverter"
                            forceSelection="true" immediate="true" dropdown="true">
                <p:ajax event="itemSelect" update="musicianAlbumstable" listener="#{mainPageViewManagedBean.musicianSelect}"/>
            </p:autoComplete>
            <p:dataTable  id="musicianAlbumstable" var="row" value="#{mainPageViewManagedBean.searchMusicianAlbums()}"  styleClass="table, centered">  
                <p:column id="modelHeader">  
                    <f:facet name="header">Альбом</f:facet>  
                    <h:outputText value="#{row}" />  
                </p:column>
            </p:dataTable> 
        </p:dialog>

        <p:dialog id="ratedAlbumsDialog" header="Рейтинг альбомов" widgetVar="ratedAlbumsDialog" showEffect="fade" hideEffect="fade" width="600">
            <h:form>
                <p:dataTable id="ratedAlbumsTable" value="#{controllerManagedBean.searchRatedAlbums()}" var="album" styleClass="table, centered">
                    <p:column>  
                        <f:facet name="header">Альбом</f:facet>  
                        <h:outputText value="#{album.key}" />  
                    </p:column>
                    <p:column>  
                        <f:facet name="header">Рейтинг</f:facet>  
                        <h:outputText value="#{album.value}">
                            <f:convertNumber pattern = "##,##"/>
                        </h:outputText> 
                    </p:column>
                </p:dataTable>
                <p:panel header="Экспорт">
                    <h:commandLink value="Экспортировать в формате pdf">
                        <p:graphicImage value="/images/pdf.png"/>
                        <p:dataExporter type="pdf" target="ratedAlbumsTable" fileName="rated albums"/>
                    </h:commandLink>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog id="musiciansByGenreDialog" header="Исполнители по жанру" widgetVar="musiciansByGenreDialog" showEffect="fade" hideEffect="fade" width="600">
            <h:form>
                <p:autoComplete id="musiciansByGenreAutoComplete" 
                                value="#{mainPageViewManagedBean.selectedGenre}" 
                                completeMethod="#{mainPageViewManagedBean.completeGenres}" 
                                var="genre" itemLabel="#{genre.name}" 
                                itemValue="#{genre}" 
                                converter="genreConverter"
                                forceSelection="true" immediate="true" dropdown="true">
                    <p:ajax event="itemSelect" update="musiciansByGenreTable" listener="#{mainPageViewManagedBean.genreSelect}"/>
                </p:autoComplete>
                <p:dataTable id="musiciansByGenreTable" value="#{mainPageViewManagedBean.searchMusicianByGenre()}" var="musician" styleClass="table, centered">
                    <p:column>  
                        <f:facet name="header">Название</f:facet>  
                        <h:outputText value="#{musician.name}" />  
                    </p:column>
                    <p:column>  
                        <f:facet name="header">Ссылка</f:facet>  
                        <h:outputText value="#{musician.link}" />  
                    </p:column>
                </p:dataTable>
                <p:panel header="Экспорт">
                    <h:commandLink value="Экспортировать в формате pdf">
                        <p:graphicImage value="/images/pdf.png"/>
                        <p:dataExporter type="pdf" target="musiciansByGenreTable" fileName="musicians by genre"/>
                    </h:commandLink>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog id="musiciansByMoodDialog" header="Исполнители по настроению" widgetVar="musiciansByMoodDialog" showEffect="fade" hideEffect="fade" width="600">
            <h:form>
                <p:autoComplete id="musiciansByMoodAutoComplete" 
                                value="#{mainPageViewManagedBean.selectedMood}" 
                                completeMethod="#{mainPageViewManagedBean.completeMoods}" 
                                var="mood" itemLabel="#{mood.name}" 
                                itemValue="#{mood}" 
                                converter="moodConverter"
                                forceSelection="true" immediate="true" dropdown="true">
                    <p:ajax event="itemSelect" update="musiciansByMoodTable" listener="#{mainPageViewManagedBean.moodSelect}"/>
                </p:autoComplete>
                <p:dataTable id="musiciansByMoodTable" value="#{mainPageViewManagedBean.searchMusicianByMood()}" var="musician" styleClass="table, centered">
                    <p:column>  
                        <f:facet name="header">Название</f:facet>  
                        <h:outputText value="#{musician.name}" />  
                    </p:column>
                    <p:column>  
                        <f:facet name="header">Ссылка</f:facet>  
                        <h:outputText value="#{musician.link}" />  
                    </p:column>
                </p:dataTable>
                <p:panel header="Экспорт">
                    <h:commandLink value="Экспортировать в формате pdf">
                        <p:graphicImage value="/images/pdf.png"/>
                        <p:dataExporter type="pdf" target="musiciansByMoodTable" fileName="musicians by mood"/>
                    </h:commandLink>
                </p:panel>
            </h:form>
        </p:dialog>
    </h:body>
</html>
